<div class="appointments-container">
    <div class="appointments-header">
        <h2>TIMELINE</h2>
        <div>
            <button class="mark-btn-active">Email Case Sheet</button>
            <button class="mark-btn-active">Dot Matrix Print</button>
            <button class="mark-btn-active">Customize Print</button>
            <button class="add-btn">+ Add</button>
        </div>
    </div>

    <div class="treatment-plan">
        <div class="timeline-layout">
            <!-- Left Sidebar -->
            <div class="filter-sidebar">
                <div class="filter-header">
                    <h3>Types</h3>
                    <div class="filter-actions">
                        <a class="action-link" (click)="deselectAll()">De-select All</a>
                        <a class="action-link" *ngIf="!areAllSelected()" (click)="selectAll()">| Select All</a>
                    </div>
                </div>
                <div class="filter-options">
                    <label class="filter-option">
                        <input type="checkbox" [(ngModel)]="filterTypes.Appointment" (change)="applyFilters()">
                        <span>Appointments</span>
                    </label>
                    <label class="filter-option">
                        <input type="checkbox" [(ngModel)]="filterTypes.FileUpload" (change)="applyFilters()">
                        <span>Files</span>
                    </label>
                    <label class="filter-option">
                        <input type="checkbox" [(ngModel)]="filterTypes.VitalSigns" (change)="applyFilters()">
                        <span>Vital Signs</span>
                    </label>
                    <label class="filter-option">
                        <input type="checkbox" [(ngModel)]="filterTypes.ClinicalNotes" (change)="applyFilters()">
                        <span>Clinical Notes</span>
                    </label>
                    <label class="filter-option">
                        <input type="checkbox" [(ngModel)]="filterTypes.TreatmentPlan" (change)="applyFilters()">
                        <span>Treatment Plans</span>
                    </label>
                    <label class="filter-option">
                        <input type="checkbox" [(ngModel)]="filterTypes.Procedure" (change)="applyFilters()">
                        <span>Procedures</span>
                    </label>
                    <label class="filter-option">
                        <input type="checkbox" [(ngModel)]="filterTypes.Invoice" (change)="applyFilters()">
                        <span>Invoices</span>
                    </label>
                    <label class="filter-option">
                        <input type="checkbox" [(ngModel)]="filterTypes.Payment" (change)="applyFilters()">
                        <span>Payments</span>
                    </label>
                </div>
            </div>
        
            <div class="timeline-area">
                <div *ngIf="!hasEvents()">
                    No events to display. Try adjusting your filters.
                </div>
                
                <div class="events-container" *ngFor="let date of getSortedDates()">
                    <div class="date-header">
                        <div class="date-main">{{ date | date: 'dd' }}</div>
                        <div class="date-detail">
                            <div>{{ date | date: 'MMMM yyyy' }}</div>
                            <div class="date-day">{{ date | date: 'EEEE' }}</div>
                        </div>
                    </div>
        
                    <div class="events-list">
                        <!-- Event items -->
                        <div class="event-item" *ngFor="let item of timeline[date]">
                            <div class="timeline-connector">
                                <span class="connector-dot"></span>
                                <i class="adjust-margin pi pi-chevron-left"></i>
                                <span style="
                                border-left: 5px solid white;
                                height: 14.5px;
                                margin-left: -6px;
                                border-radius: 20px 0px 0px 20px;
                            "></span>
                            </div>
                            <div class="event-card" *ngIf="item.type === 'TreatmentPlan'">
                                <div class="event-header">
                                    <div class="event-type">
                                        <i class="icon-procedure"></i>
                                        Treatment Plan Added
                                    </div>
                                </div>
                                <div class="event-body">
                                    <div class="doctor-name">Procedure: {{item.treatment_name}}</div>
                                    <div class="doctor-name">{{'Dr.' + item.doctor_name}}</div>
                                </div>
                            </div>
                            <div class="event-card" *ngIf="item.type === 'Payment'">
                                <div class="event-header">
                                    <div class="event-type">
                                        <i class="icon-procedure"></i>
                                        Payment
                                    </div>
                                </div>
                                <div class="event-body">
                                    <div class="doctor-name">{{item.receipt_id}}</div>
                                    <div class="doctor-name">{{'Amount Paid:' + item.amount_paid}}</div>
                                </div>
                            </div>
                            <div class="event-card" *ngIf="item.type === 'FileUpload'">
                                <div class="event-header">
                                    <div class="event-type">
                                        <i class="icon-procedure"></i>
                                        Invoice
                                    </div>
                                </div>
                                <div class="event-body">
                                    <div class="doctor-name">{{item.name}}</div>
                                    <img [src]="item.file_path">
                                </div>
                            </div>
                            <div class="event-card" *ngIf="item.type === 'Invoice'">
                                <div class="event-header">
                                    <div class="event-type">
                                        <i class="icon-procedure"></i>
                                        Invoice
                                    </div>
                                </div>
                                <div class="event-body">
                                    <div class="doctor-name">{{item.invoice_id}}</div>
                                </div>
                            </div>
                            <div class="event-card" *ngIf="item.type === 'Appointment'">
                                <div class="event-header">
                                    <div class="event-type">
                                        <i class="icon-procedure"></i>
                                        Appointment Created
                                    </div>
                                </div>
                                <div class="event-body">
                                    <div class="doctor-name">Booking Type: {{item.booking_type}}</div>
                                    <div class="doctor-name">{{'Dr.' + item.doctor_name}}</div>
                                    <div>{{item.appointment_date | date: 'dd MMM, yyyy'}} {{item.appointment_time}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>